var core;function AnySignApi(){this.CALLBACK_TYPE_SIGNATURE=1;this.CALLBACK_TYPE_DIALOG_DISMISS=2;this.CALLBACK_TYPE_DIALOG_CANCEL=3;this.CALLBACK_TYPE_BUFFER_SAVED=4;this.CALLBACK_TYPE_ON_PICTURE_TAKEN=5;this.CALLBACK_TYPE_DATA_DELETED=6;this.CALLBACK_TYPE_START_RECORDING=7;this.CALLBACK_TYPE_STOP_RECORDING=8;this.CALLBACK_TYPE_ON_MEDIA_DATA=9;this.CALLBACK_TYPE_COMMENTSIGN=10;this.CALLBACK_TYPE_ERROR=-1;this.CALLBACK_TYPE_ERROR_PICTURE=-2;this.CALLBACK_TYPE_OPERATION_CANCELED=-3;this.CALLBACK_TYPE_GETVERSION=10;this.RESULT_OK=0;this.RESULT_ERROR=-1;this.EC_API_NOT_INITED=1;this.EC_WRONG_CONTEXT_ID=2;this.EC_CAMERA_INIT_FAILED=3;this.EC_NATIVE_EXCEPTION=4;this.EC_DEVICE_NOT_SUPPORTED=5;this.EC_TEMPLATE_NOT_SET=6;this.initAnySignApi=function(callback,channel){if(callback&&callback instanceof Function&&callback.length>=3){core=new anysignWebImpl;core._initAnySignApi(callback,channel);return true}else{return false}};this.addDataObj=function(context_id,dataConfig){if(!dataConfig instanceof DataConfig){return false}return core._addDataObj(context_id,dataConfig)};this.addSignatureObj=function(context_id,signatureConfig){if(!signatureConfig instanceof SignatureConfig)return false;return core._addSignatureObj(context_id,signatureConfig)};this.addCommentObj=function(context_id,signatureConfig){if(!signatureConfig instanceof SignatureConfig)return false;return core._addCommentObj(context_id,signatureConfig)};this.addEvidence=function(context_id,content,format,bioType,index){return core._addEvidence(context_id,content,format,bioType,index)};this.addCachetObj=function(cachetConfig){if(!(cachetConfig instanceof CachetConfig)){return false}return core._addChachetObj(cachetConfig)};this.addPhotoObj=function(context_id,photoConfig){if(!(photoConfig instanceof PhotoConfig))return false;return true};this.addMediaObj=function(context_id,mediaConfig){if(!(mediaConfig instanceof MediaConfig))return false;return true};this.setTemplate=function(template_type,contentUtf8Str,businessId,template_serial){if(core)return core._setTemplate(template_type,contentUtf8Str,businessId,template_serial);else return false};this.setTID=function(tid){return core._setTID(tid)};this.setData=function(context_id,data){return core._setData(context_id,data)};this.showSignatureDialog=function(context_id){return core._showSignatureDialog(context_id)};this.showCommentDialog=function(context_id){return core._showCommentDialog(context_id)};this.setIdentifyCallBack=function(callBack){return core._setIdentifyCallBack(callBack)};this.commitConfig=function(){return core._commitConfig()};this.resetConfig=function(){return core._resetConfig()};this.isReadyToUpload=function(){return core._isReadyToUpload()};this.getUploadDataGram=function(n){return core._getUploadDataGram(n)};this.saveBusiness=function(encKey){return core._saveBusinessSession(encKey)};this.restoreBusiness=function(encData,desKey){return core._restoreBusinessSession(encData,desKey)};this.getVersion=function(){return"AnySign_V1.3.3_Web_2.3.0"};this.getOSInfo=function(){return core._getOSInfo()}}function DataConfig(){this.cid=0;this.name=null;this.format=null;this.nessesary=true}function SignatureConfig(signer,signRule){if(!signer||!signRule){throw"SignatureConfig constructor parameter signer or signRule could not be null."}if(!(signRule instanceof SignRule_KeyWord)&&!(signRule instanceof SignRule_Tid)&&!(signRule instanceof SignRule_XYZ)&&!(signRule instanceof SignRule_KeyWordV2)&&!(signRule instanceof SignRule_KeyWordV3)){throw"SignatureConfig constructor parameter signRule invalid, should be instance of SignRule_KeyWord or SignRule_Tid or SignRule_XYZ"}this.signer=signer;this.signRule=signRule;this.cid=0;this.title="请投保人刘伟签名";this.titleSpanFromOffset=4;this.titleSpanToOffset=5;this.isTSS=false;this.nessesary=false;this.singleWidth=500;this.singleHeight=500;this.penColor="#000000";this.signatureImgRatio=1;this.timeTag=null;this.isdistinguish=false;this.ocrCapture=null}function CommentConfig(signer,signRule){if(!signer||!signRule){throw"CommentConfig constructor parameter signer or signRule could not be null."}if(!(signRule instanceof SignRule_KeyWord)&&!(signRule instanceof SignRule_Tid)&&!(signRule instanceof SignRule_XYZ)&&!(signRule instanceof SignRule_KeyWordV2)&&!(signRule instanceof SignRule_KeyWordV3)){throw"SignatureConfig constructor parameter signRule invalid, should be instance of SignRule_KeyWord or SignRule_Tid or SignRule_XYZ"}this.signer=signer;this.signRule=signRule;this.cid=30;this.commitment="本人已阅读保险条款、产品说明书和投保提示书，了解本产品的特点和保单利益的不确定性。";this.mass_words_in_single_line=25;this.mass_word_height=75;this.mass_word_width=50;this.isTSS=false;this.penColor="#000000";this.nessesary=false;this.isdistinguish=false;this.ocrCapture=null;this.isShowBgText=true;this.currentEditBarTextColor="#FF0000"}function OCRCapture(){this.text="a";this.IPAdress="";this.appID="";this.serviceID="";this.resolution=80;this.language=Language.CHS;this.count=10}function CachetConfig(signer,signRule,isTss){if(!(signer instanceof Signer)){throw"CachetConfig constructor parameter signer invalid"}this.Signer=signer;if(!(signRule instanceof SignRule_KeyWord)&&!(signRule instanceof SignRule_Tid)&&!(signRule instanceof SignRule_XYZ)&&!(signRule instanceof SignRule_KeyWordV2)&&!(signRule instanceof SignRule_KeyWordV3)){throw"CachetConfig constructor parameter signRule invalid, should be instance of SignRule_KeyWord or SignRule_Tid or SignRule_XYZ"}this.SignRule=signRule;this.IsTSS=isTss}function anysignCommentUI(){var commentObjTmp;var inner_string;var commentInner;var dlg;var signButtonImg="url(data:image/gif;base64,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)";this.onload_commentSignCanvas=function(obj,identifyCallBack){commentObjTmp=obj;inner_string=commentObjTmp.commitment;commentInner=inner_string.replace(/(.)(?=[^$])/g,"$1,").split(",");window.onmousewheel=document.onmousewheel=function(){return false};document.documentElement.style.overflow="hidden";dlg=document.getElementById("comment_dialog");dlg.style.width=getWindowWidth();dlg.style.height=getWindowHeight();dlg.style.display="block";var title=document.getElementById("comment_title");title.style.fontSize="20px";loadView();new anysignCommentCore(inner_string,line_count,commentObjTmp,identifyCallBack)};function loadView(){var canvas=document.getElementById("comment_canvas");var ctx=canvas.getContext("2d");var tmp_dlg=document.getElementById("comment_dialog");tmp_dlg.style.width=getWindowWidth();tmp_dlg.style.height=getWindowHeight();if(window.orientation==0||window.orientation==180){document.getElementById("comment_title").style.width=getWindowWidth()+"px";document.getElementById("signImage").style.cssFloat="none";document.getElementById("signImage").style.clear="both";document.getElementById("signImage").style.width=getWindowWidth()*.95+"px";document.getElementById("signImage").style.height=getWindowHeight()/6+"px";document.getElementById("tmpcanvascss").style.cssFloat="none";document.getElementById("tmpcanvascss").style.clear="both";document.getElementById("tmpcanvascss").style.width=getWindowWidth()*.95+"px";document.getElementById("tmpcanvascss").style.height=getWindowHeight()/2+"px";var text=document.getElementById("signTitle");text.style.width=getWindowWidth()*.95;text.style.height=getWindowHeight()/2;text.style.fontSize=getWindowWidth()*.9/3+"px";text.style.color="#E5E5E5";text.style.textAlign="center";text.style.cssText+="text-align:center";text.style.lineHeight=getWindowHeight()/2+"px";text.style.position="absolute";text.style.cssFloat="right";text.style.clear="none";document.getElementById("comment_canvas").style.cssFloat="right";document.getElementById("comment_canvas").style.clear="none";document.getElementById("comment_canvas").width=getWindowWidth()*.95;document.getElementById("comment_canvas").height=getWindowHeight()/2;document.getElementById("comment_canvas").style.backgroundImage=signButtonImg;document.getElementById("comment_canvas").style.backgroundRepeat="no-repeat";document.getElementById("comment_canvas").style.backgroundSize=getWindowWidth()*.95+"px "+getWindowHeight()*.5+"px";document.getElementById("comment_canvas").style.position="absolute";var signImg_width=getWindowWidth()*.9}else{document.getElementById("comment_title").style.width=getWindowWidth()*.9/2+"px";document.getElementById("comment_title").innerHTML=commentObjTmp.commitment;document.getElementById("leftView").style.cssFloat="left";document.getElementById("leftView").style.clear="none";document.getElementById("signImage").style.width=getWindowWidth()*.9/2+"px";document.getElementById("signImage").style.height=getWindowHeight()*.68-$("#comment_title").height()+"px";document.getElementById("signImage").focus();document.getElementById("tmpcanvascss").style.cssFloat="right";document.getElementById("tmpcanvascss").style.clear="none";document.getElementById("tmpcanvascss").style.width=getWindowWidth()/2+"px";document.getElementById("tmpcanvascss").style.height=getWindowHeight()*.8+"px";document.getElementById("tmpcanvascss").style.marginRight=10+"px";var text=document.getElementById("signTitle");text.style.width=getWindowWidth()/2+"px";text.style.height=getWindowHeight()*.8+"px";text.style.fontSize=getWindowWidth()*.9/4+"px";text.style.color="#E5E5E5";text.style.textAlign="center";text.style.cssText+="text-align:center";text.style.lineHeight=getWindowHeight()*.8+"px";text.style.position="absolute";text.style.cssFloat="right";text.style.clear="none";document.getElementById("comment_canvas").style.cssFloat="right";document.getElementById("comment_canvas").style.clear="none";document.getElementById("comment_canvas").width=getWindowWidth()/2;document.getElementById("comment_canvas").height=getWindowHeight()*.8;document.getElementById("comment_canvas").style.backgroundImage=signButtonImg;document.getElementById("comment_canvas").style.backgroundRepeat="no-repeat";document.getElementById("comment_canvas").style.backgroundSize=getWindowWidth()*.5+"px "+getWindowHeight()*.8+"px";document.getElementById("comment_canvas").style.position="absolute";document.getElementById("tmpcanvascss").appendChild(document.getElementById("comment_canvas"));var signImg_width=getWindowWidth()*.95/2}line_count=signImg_width/commentObjTmp.mass_word_width-1}window.addEventListener("orientationchange",function(){loadView()});window.addEventListener("resize",function(){loadView()})}var TimeTag=function(position,format){if(!position||!format||position.length===0||format.length===0){throw"TimeTag constructor parameter { and position could not be null or empty"}this.Pos=position;this.Format=format};var DataFormat={IMAGE_GIF:"image/gif",IMAGE_JPEG:"image/jpeg",IMAGE_PNG:"image/png",MEDIA_AU:"media/au",MEDIA_AIFF:"media/aiff",MEDIA_WAVE:"media/wave",MEDIA_MIDI:"media/midi",MEDIA_MP4:"media/mp4",MEDIA_M4V:"media/m4v",MEDIA_3G2:"media/3g2",MEDIA_3GP2:"media/3gp2",MEDIA_3GP:"media/3gp",MEDIA_3GPP:"media/3gpp"};var TemplateType={XML:10,HTML:11,PDF:12,JSON:13,PRESERVED:19};var EncAlgType={EncAlg:"RSA"};var BioType={PHOTO_SIGNER_IDENTITY_CARD_FRONT:0,PHOTO_SIGNER_IDENTITY_CARD_BACK:1,SOUND_SIGNER_RETELL:2,SOUND_SIGNER_OTHER:3};var Language={CHS:1,CHT:2};var SignRule_KeyWord=function(keyword,keyWordAlignMethod,keyWordOffset,keyWordSerialNum,KWIndex){if(!keyword||keyword.length===0){throw"SignRule_KeyWordV2 constructor parameter keyword could not be null or empty"}if(keyWordAlignMethod!==1&&keyWordAlignMethod!==2&&keyWordAlignMethod!==3&&keyWordAlignMethod!=4){throw"SignRule_KeyWord constructor parameter keyWordAlignMethod invalid, should be one of '1' '2' '3' '4'"}this.RuleType="0";if(!isNaN(keyWordSerialNum)&&!isNaN(keyWordOffset)&&!isNaN(KWIndex)){this.KWRule={KW:keyword,KWPos:keyWordAlignMethod,KWOffset:keyWordOffset,Pageno:keyWordSerialNum,KWIndex:KWIndex,XOffset:0,YOffset:0}}};var SignRule_KeyWordV2=function(keyword,xOffset,yOffset,keyWordSerialNum,KWIndex){if(!keyword||keyword.length===0){throw"SignRule_KeyWordV2 constructor parameter keyword could not be null or empty"}this.RuleType="0";if(!isNaN(keyWordSerialNum)&&!isNaN(KWIndex)){this.KWRule={KW:keyword,KWPos:0,KWOffset:0,XOffset:xOffset,YOffset:yOffset,Pageno:keyWordSerialNum,KWIndex:KWIndex}}};var SignRule_Tid=function(tid){if(!tid||tid.length===0){throw"SignRule_Tid constructor parameter tid could not be null or empty"}this.RuleType="2";this.Tid=tid};var SignRule_XYZ=function(left,top,right,bottom,keyWordSerialNum,unit){if(isNaN(left)||isNaN(top)||isNaN(right)||isNaN(bottom)||isNaN(keyWordSerialNum)){throw"SignRule_XYZ constructor parameter invalid, only float or int permitted"}if(right<left){throw"SignRule_XYZ constructor left must be less than right"}if(top<bottom){throw"SignRule_XYZ constructor top must not be less than bottom"}if(!unit||unit!=="pt"&&unit!=="dp"){throw"SignRule_XYZ constructor parameter unit can only be 'dp' or 'pt'"}this.RuleType="1";this.XYZRule={Left:left,Top:top,Right:right,Bottom:bottom,Pageno:keyWordSerialNum,Unit:unit}};var Signer=function(name,id_num){if(!name||!id_num||name.length===0||id_num.length===0){throw"Signer constructor parameter name and id could not be null or empty"}this.UName=name;this.IDNumber=id_num;this.IDType="1"};