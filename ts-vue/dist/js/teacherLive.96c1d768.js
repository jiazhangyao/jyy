(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["teacherLive"],{"07ce":function(e,t,n){"use strict";var s=n("46f3"),i=n.n(s);i.a},"08e0":function(e,t,n){"use strict";var s=n("1bd6"),i=n.n(s);i.a},"1bd6":function(e,t,n){},"2e74":function(e,t,n){},"375b":function(e,t,n){e.exports=n.p+"img/subject.9f77f178.png"},4387:function(e,t,n){e.exports=n.p+"img/redPackets.0af72fdb.png"},"46f3":function(e,t,n){},"50e7":function(e,t,n){e.exports=n.p+"img/ranking.b6f8f7c1.png"},"56ba":function(e,t,n){"use strict";var s=n("a621"),i=n.n(s);i.a},"7eef":function(e,t,n){"use strict";var s=n("cb3d"),i=n.n(s);i.a},"80d2":function(e,t,n){"use strict";var s=n("f679"),i=n.n(s);i.a},8280:function(e,t,n){"use strict";n.r(t);var s=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{attrs:{id:"teacherLive"}},[e.loading?s("div",{staticClass:"loading"},[s("a-spin",{staticClass:"loading-spin",attrs:{tip:"正在初始化"}},[s("a-icon",{staticStyle:{"font-size":"1rem"},attrs:{slot:"indicator",type:"loading",spin:""},slot:"indicator"})],1)],1):e._e(),s("TopBar",{attrs:{interactionMenuOpenState:e.interactionMenuOpenState,onlineUserCount:e.onlineUserList.length,selectedTab:e.selectedTabName},on:{switchTab:e.handleSwitchTab,interactionMenuOpenStateChange:e.handleInteractionMenuOpenStateChange}}),s("div",{staticClass:"teacherLiveContainer",style:{height:e.containerHeight+"px",transform:e.interactionMenuOpenState?"translateX(0)":"",transition:e.interactionMenuClicked?"transform .2s ease-in-out":""}},[s("ul",{staticClass:"interactionMenu"},[s("li",{staticClass:"interactionMenuChunk",on:{click:e.handleTestClick}},[s("img",{staticClass:"interactionMenuChunkImg",attrs:{src:n("375b"),alt:"题目"}}),s("span",{staticClass:"interactionMenuChunkValue"},[e._v("题目")])]),s("li",{staticClass:"interactionMenuChunk",on:{click:e.handleRedPacketClick}},[s("img",{staticClass:"interactionMenuChunkImg",attrs:{src:n("4387"),alt:"红包"}}),s("span",{staticClass:"interactionMenuChunkValue"},[e._v("红包")])]),s("li",{staticClass:"interactionMenuChunk",on:{click:e.handleRankClick}},[s("img",{staticClass:"interactionMenuChunkImg",attrs:{src:n("50e7"),alt:"排行"}}),s("span",{staticClass:"interactionMenuChunkValue"},[e._v("排行")])])]),s("div",{staticClass:"teacherLiveMain",on:{mousedown:e.handlePageClick}},[s("div",{staticClass:"area area-top",style:{height:e.areaTopHeight+"px"}},[s("ChatRoom",{ref:"chatRoom",style:{"z-index":"barrage"===e.selectedTabName?"1":"-1"},attrs:{speakList:e.speakList}}),s("OnlineUser",{ref:"onlineUser",style:{"z-index":"onlineUser"===e.selectedTabName?"1":"-1"},attrs:{onlineUserList:e.onlineUserList,onlineUserListPageCount:e.onlineUserListPageCount,onlineUserListPageNumber:e.onlineUserListPageNumber,scrollLoadingFLag:e.scrollLoadingFLag},on:{getOnlineUserList:e.handleGetOnlineUserList}})],1),s("div",{staticClass:"sizeControlLine",on:{mousedown:function(t){return t.preventDefault(),t.stopPropagation(),e.handleMouseDown(t)}}},[s("span")]),s("div",{staticClass:"area area-bottom",style:{height:e.areaBottomHeight+"px"}},[s("div",{class:{animation:!e.mouseDownFlag},style:{height:e.teacherAnswerShowStatus?e.areaBottomHeight+"px":e.areaBottomHeight+e.teacherAnswerHeight+"px"},attrs:{id:"area-bottom-container"}},[s("StudentQuestion",{ref:"studentQuestion",attrs:{studentQuestionList:e.studentQuestionList},on:{selectQuestion:e.handleSelectQuestion}}),s("TeacherAnswer",{attrs:{teacherAnswerShowStatus:e.teacherAnswerShowStatus,teacherAnswerInfo:e.teacherAnswerInfo},on:{sendAnswer:e.handleSendAnswer,cancelAnswer:e.handlePageClick}})],1)])])])],1)},i=[],a=n("d4ec"),o=n("bee2"),r=n("99de"),c=n("7e84"),u=n("262e"),l=n("9ab4"),h=n("60a3"),d=(n("a4d3"),n("e01a"),n("d28b"),n("99af"),n("4de4"),n("c740"),n("4160"),n("c975"),n("a15b"),n("fb6a"),n("b0c0"),n("a9e3"),n("b64b"),n("d3b7"),n("ac1f"),n("25f0"),n("3ca3"),n("466d"),n("5319"),n("1276"),n("159b"),n("ddb0"),n("2909")),f=n("53ca"),p=n("6e7c"),m=n("c080"),v=n("efee"),g=n("5a0c"),b=n.n(g),y=n("ee50"),k=n("2e1a"),C=n("4938"),O=function(e){function t(){var e;return Object(a["a"])(this,t),e=Object(r["a"])(this,Object(c["a"])(t).apply(this,arguments)),e.loading=!0,e.subjectId=323,e.planId=1504,e.roomId=565988,e.onlineUserList=[],e.onlineUserListPageCount=40,e.onlineUserListPageNumber=1,e.speakList=[],e.scrollLoadingFLag=!1,e.studentQuestionList=[],e.studentInfoFindListCache={},e.polyvUserId=e.$store.state.userInfo.id+"_",e.userType="SPEAKER"===e.$store.state.userInfo.role?"teacher":"assistant",e.teacherAnswerInfo={},e.teacherAnswerShowStatus=!1,e.teacherAnswerHeight=162,e}return Object(u["a"])(t,e),Object(o["a"])(t,[{key:"mounted",value:function(){var e=this,t=function(){Object(m["g"])(e.roomId.toString(),e.polyvUserId,e.userType).then((function(t){e.initChatRoom(t.data.data)}))};if(console.log(void 0!==Object(f["a"])(this.$store.state.userInfo)),void 0!==Object(f["a"])(this.$store.state.userInfo)){if("SPEAKER"!==this.$store.state.userInfo.role)return void this.$message.error("你不是主讲老师！")}else this.$message.error("你还没有登录！"),this.$router.replace("./login");if("string"!==typeof this.$route.query.roomId&&"number"!==typeof this.$route.query.roomId||(this.roomId=Number(this.$route.query.roomId)),"string"!==typeof this.$route.query.planId&&"number"!==typeof this.$route.query.planId||(this.planId=Number(this.$route.query.planId)),"string"!==typeof this.$route.query.subjectId&&"number"!==typeof this.$route.query.subjectId||(this.subjectId=Number(this.$route.query.subjectId)),this.polyvUserId=this.$store.state.userInfo.id+"_"+this.subjectId,"undefined"===typeof PolyvChatRoom){var n=document.createElement("script");n.type="text/javascript",n.src=p["a"],document.getElementsByTagName("head")[0].appendChild(n),n.onload=t}else t();console.log(this.onlineUser)}},{key:"initChatRoom",value:function(e){var t=this;this.startTimeStamp=(new Date).getTime(),this.polyvChatRoom=new PolyvChatRoom({roomId:this.roomId.toString(),userId:this.polyvUserId,pic:"http://livestatic.videocc.net/assets/wimages/missing_face.png",nick:this.$store.state.userInfo.name,userType:this.userType,token:e.token,mediaChannelKey:e.mediaChannelKey,version:"2.0",roomMessage:function(e){if(console.log(e),"error"!==e.status)switch(e.EVENT){case"LOGIN":t.reloadOnlineUserList();break;case"LOGOUT":t.reloadOnlineUserList();break;case"TEACHER_INFO":break;case"O_TEACHER_INFO":break;case"SPEAK":t.handleChatSpeak(e);break;case"SEND_MESSAGE":break;case"KICK":t.reloadOnlineUserList();break;case"ADD_SHIELD":t.handleShieldStatusChange(e);break;case"REMOVE_SHIELD":t.handleShieldStatusChange(e);break;case"S_QUESTION":t.handleStudentAskQuestion(e);break;case"T_ANSWER":t.handleStudentAskQuestion(e);break;case"REWARD":t.handleStudentReward(e);break}else t.$message.error(e.message)}}),this.chat=this.polyvChatRoom.chat,this.chatSocket=this.chat.socket,Promise.all([this.getHistoryMessage(),this.handleGetOnlineUserList({onlineUserListPageNumber:this.onlineUserListPageNumber,onlineUserListPageCount:this.onlineUserListPageCount}),this.createJiahuiSocket()]).then((function(e){t.getStudentAskQuestionHistory().then((function(){t.loading=!1,t.teacherAnswerHeight=document.getElementById("teacherAnswer").clientHeight}))})).catch((function(e){console.log(e),t.loading=!1,t.$message.error("初始化失败，请重试")}))}},{key:"getHistoryMessage",value:function(){var e=this;return Object(m["e"])(this.roomId.toString(),b()(this.startTimeStamp-72e5).format("YYYY-MM-DD HH:mm:ss"),b()(this.startTimeStamp).format("YYYY-MM-DD HH:mm:ss")).then((function(t){for(var n=t.data.data,s=t.data.data.length-1;s>=0;s--)e.speakList.unshift({id:n[s].id,user:n[s].user,time:n[s].time,content:"string"===typeof n[s].content?e.replaceAllExpress(n[s].content):n[s].content,msgType:n[s].msgType})})).then((function(){e.chatRoom.scrollToBottom()}))}},{key:"handleChatSpeak",value:function(e){e.content=this.replaceAllExpress(e.content),this.speakList.push(e)}},{key:"replaceAllExpress",value:function(e){var t="";function n(e){var s=e.match(v["b"]);if(null!==s){var i=v["a"].indexOf(s[0]);t=-1!==i?t.concat(e.slice(0,s.index)+'<img class="express_img" src="'.concat(v["d"]+(i+1),'.png" alt="').concat("string"===typeof s[0]?"[".concat(s[0],"]"):"",'"/>')):t.concat(e.slice(0,s.index)+s[0]),n(e.slice(s[0].length+s.index))}else t=t.concat(e)}return n(e),t}},{key:"handleGetOnlineUserList",value:function(e){var t=this;this.chat.getUserList(e.onlineUserListPageNumber,e.onlineUserListPageCount).then((function(e){var n,s=[],i=[];e.userlist.forEach((function(e,t){"teacher"===e.userType&&i.push(t)})),s=e.userlist.filter((function(e,t){if(-1===i.indexOf(t))return e})),(n=t.onlineUserList).push.apply(n,Object(d["a"])(s))}))}},{key:"reloadOnlineUserList",value:function(){var e=this;this.scrollLoadingFLag=!0,clearTimeout(this.onlineUserListReloadTimer),this.onlineUserListReloadTimer=setTimeout((function(){e.onlineUserListPageNumber=1,e.onlineUserListPageCount=40,e.onlineUserList=[],e.handleGetOnlineUserList({onlineUserListPageNumber:e.onlineUserListPageNumber,onlineUserListPageCount:e.onlineUserListPageCount}),e.onlineUser.scrollToTop(),e.scrollLoadingFLag=!1}),1e3)}},{key:"handleShieldStatusChange",value:function(e){if(console.log(e,this.onlineUserList),"userId"===e.data.banType){var t=this.onlineUserList.findIndex((function(t){return t.userId===e.data.userId}));console.log(t),-1!==t&&(this.onlineUserList[t].banned="ADD_SHIELD"===e.EVENT)}}},{key:"handleStudentAskQuestion",value:function(e){e.content=this.replaceAllExpress(e.content);var t=this.studentQuestionList.push(e);if("T_ANSWER"===e.EVENT&&(this.selectNeedInfoUserIdPushInCache(e,t-1),"string"===typeof e.s_userId&&""!==e.s_userId&&(this.findUserNameByUserIds([e.s_userId.split("_")[0]]),null!==this.teacherAnswerInfo&&void 0!==this.teacherAnswerInfo.messageData))){var n=JSON.parse(this.teacherAnswerInfo.messageData);e.user.userId===this.polyvUserId&&e.content===n.content&&e.s_userId===n.s_userId&&this.$set(this.studentQuestionList[t-1],"studentContent",this.teacherAnswerInfo.content)}}},{key:"getStudentAskQuestionHistory",value:function(){var e=this;return Object(m["f"])(this.roomId.toString()).then((function(t){for(var n=t.data.data,s=0;s<=n.length-1;s++)e.studentQuestionList.unshift({id:n[s].id,user:n[s].user,time:n[s].time,content:e.replaceAllExpress(n[s].content),s_userId:n[s].s_userId,EVENT:n[s].event});for(var i=0;i<=e.studentQuestionList.length-1;i++)e.selectNeedInfoUserIdPushInCache(e.studentQuestionList[i],i);console.log(e.studentInfoFindListCache);var a=Object.keys(e.studentInfoFindListCache);a.length>0&&e.findUserNameByUserIds(a)})).then((function(){e.studentQuestion.scrollToBottom()}))}},{key:"selectNeedInfoUserIdPushInCache",value:function(e,t){if("T_ANSWER"===e.EVENT&&"string"===typeof e.s_userId&&""!==e.s_userId){var n=e.s_userId.split("_")[0];this.studentInfoFindListCache.hasOwnProperty(n)?this.studentInfoFindListCache[n].idxs.push(t):this.studentInfoFindListCache[n]={idxs:[t],name:k["b"],mobile:"",s_userid:e.s_userId}}}},{key:"findUserNameByUserIds",value:function(e){var t=this,n=e.join(",");this.checkJiahuiSocketIsReady(this.jiahuiSocket).then((function(e){t.jiahuiSocket.send(JSON.stringify({userId:t.$store.state.userInfo.id,messageType:"select",ids:n,token:Object(y["b"])()}))})).catch((function(e){}))}},{key:"handleSelectQuestion",value:function(e){console.log("handleSelectQuestion",e),"S_QUESTION"!==e.event&&"S_QUESTION"!==e.EVENT||(this.teacherAnswerShowStatus=!0,this.teacherAnswerInfo={user:e.user,content:e.content})}},{key:"handlePageClick",value:function(e){this.teacherAnswerHeight=document.getElementById("teacherAnswer").clientHeight,this.teacherAnswerShowStatus=!1}},{key:"handleSendAnswer",value:function(e){var t=JSON.stringify({EVENT:"T_ANSWER",roomId:this.roomId,user:{userId:this.polyvUserId,pic:"http://livestatic.videocc.net/assets/wimages/missing_face.png",nick:this.$store.state.userInfo.name,userType:this.userType,actor:"teacher"===this.userType?"讲师":"助教"},s_userId:e.s_userId,content:e.content});this.chatSocket.emit("message",t),this.teacherAnswerInfo.messageData=t}},{key:"createJiahuiSocket",value:function(){var e=this;return new Promise((function(t,n){clearTimeout(e.reLinkTimer),e.jiahuiSocket=Object(m["h"])(e.$store.state.userInfo.id.toString(),e.planId.toString()),console.log(e.jiahuiSocket),e.jiahuiSocket.onopen=function(e){t(e)},e.jiahuiSocket.onerror=function(t){e.jiahuiSocket.close(),console.log("error",t,e.jiahuiSocket),n(t)},e.jiahuiSocket.onclose=function(t){console.log("closed",t,e.jiahuiSocket),e.reLinkTimer=setTimeout((function(){e.createJiahuiSocket()}),1e3*C["a"]),n(t)},e.jiahuiSocket.onmessage=function(t){e.handleJiahuiSocketOnMessage(t)}}))}},{key:"handleJiahuiSocketOnMessage",value:function(e){var t;console.log(JSON.parse(e.data));try{t=JSON.parse(e.data)}catch(e){console.log(e)}if(console.log(t),"0"===t.code)switch(t.event){case"select_member":this.handleSelectMemberOver(t);break}else console.log("scoketResponseErr:",t)}},{key:"handleSelectMemberOver",value:function(e){console.log(e);var t=!0,n=!1,s=void 0;try{for(var i,a=e.data[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){var o=i.value;this.studentInfoFindListCache.hasOwnProperty(o.id)&&(this.studentInfoFindListCache[o.id].mobile=o.mobile,this.studentInfoFindListCache[o.id].name=o.name)}}catch(y){n=!0,s=y}finally{try{t||null==a.return||a.return()}finally{if(n)throw s}}var r=[];for(var c in this.studentInfoFindListCache)if(this.studentInfoFindListCache.hasOwnProperty(c)){var u=this.studentInfoFindListCache[c].name;if(u!==k["b"]&&""!==u){var l=!0,h=!1,d=void 0;try{for(var f,p=this.studentInfoFindListCache[c].idxs[Symbol.iterator]();!(l=(f=p.next()).done);l=!0){var m=f.value;this.$set(this.studentQuestionList[m],"studentName",u)}}catch(y){h=!0,d=y}finally{try{l||null==p.return||p.return()}finally{if(h)throw d}}}r.push(c)}for(var v=0,g=r;v<g.length;v++){var b=g[v];this.studentInfoFindListCache[b].idxs=[]}}},{key:"checkJiahuiSocketIsReady",value:function(e){return new Promise((function(t,n){switch(e.readyState){case 0:n("connecting");case 1:t("open");case 2:n("closing");case 3:n("closed")}}))}},{key:"handleStudentReward",value:function(e){e.user=e.content.rewardUser,e.msgType="reward",this.speakList.push(e)}},{key:"destroyed",value:function(){this.destroyAll()}},{key:"beforeRouteLeave",value:function(e,t,n){this.destroyAll(),n()}},{key:"destroyAll",value:function(){clearTimeout(this.reLinkTimer),clearTimeout(this.onlineUserListReloadTimer),this.chatSocket.close(),this.jiahuiSocket.close()}}]),t}(h["f"]);Object(l["a"])([Object(h["e"])()],O.prototype,"chatRoom",void 0),Object(l["a"])([Object(h["e"])()],O.prototype,"onlineUser",void 0),Object(l["a"])([Object(h["e"])()],O.prototype,"studentQuestion",void 0),O=Object(l["a"])([h["a"]],O);var S=O,w=1080;function I(){var e=document.documentElement,t=e.clientWidth;e.clientHeight;t&&(e.style.fontSize=t>=w?"100px":t/w*100+"px")}var T=function(e){function t(){var e;return Object(a["a"])(this,t),e=Object(r["a"])(this,Object(c["a"])(t).apply(this,arguments)),e.limitHeight=405,e.controlLineHeight=12,e.containerHeight=1920,e.areaTopHeight=e.containerHeight/2-e.controlLineHeight,e.areaBottomHeight=e.containerHeight-e.controlLineHeight-e.areaTopHeight-2,e.mouseDownFlag=!1,e.beforeScreenY=0,e}return Object(u["a"])(t,e),Object(o["a"])(t,[{key:"mounted",value:function(){this.computeSize(),window.addEventListener("resize",this.debounceComputeSize)}},{key:"destroyed",value:function(){window.removeEventListener("resize",this.debounceComputeSize),document.documentElement.style.fontSize=""}},{key:"handleMouseDown",value:function(e){this.mouseDownFlag=!0,this.beforeScreenY=e.screenY,this.limitHeight=document.getElementById("teacherAnswer").clientHeight,window.addEventListener("mousemove",this.handleMouseMove),window.addEventListener("mouseup",this.handleMouseUp),window.addEventListener("mouseleave",this.handleMouseLeave),document.documentElement.style.cursor="ns-resize"}},{key:"handleMouseMove",value:function(e){if(this.mouseDownFlag){if(this.beforeScreenY-e.screenY>=0&&this.areaTopHeight<=this.limitHeight)return;if(e.screenY-this.beforeScreenY>0&&this.areaBottomHeight<=this.limitHeight)return;this.areaTopHeight=this.areaTopHeight-(this.beforeScreenY-e.screenY),this.areaBottomHeight=this.containerHeight-this.controlLineHeight-this.areaTopHeight-2,this.beforeScreenY=e.screenY}}},{key:"handleMouseUp",value:function(e){this.mouseDownFlag=!1,window.removeEventListener("mousemove",this.handleMouseMove),window.removeEventListener("mouseup",this.handleMouseUp),window.removeEventListener("mouseleave",this.handleMouseLeave),document.documentElement.style.cursor="",this.chatRoom.scrollToBottom(),this.studentQuestion.scrollToBottom()}},{key:"handleMouseLeave",value:function(e){this.mouseDownFlag=!1,window.removeEventListener("mousemove",this.handleMouseMove),window.removeEventListener("mouseup",this.handleMouseUp),window.removeEventListener("mouseleave",this.handleMouseLeave),document.documentElement.style.cursor="",this.chatRoom.scrollToBottom(),this.studentQuestion.scrollToBottom()}},{key:"debounceComputeSize",value:function(){var e=this;clearTimeout(this.debounceComputeSizeTimer),this.debounceComputeSizeTimer=setTimeout((function(){e.computeSize()}),200)}},{key:"computeSize",value:function(){I(),this.containerHeight=window.innerHeight-document.getElementById("teacherLiveTopBar").clientHeight,this.areaTopHeight=this.containerHeight/2-this.controlLineHeight,this.areaBottomHeight=this.containerHeight-this.controlLineHeight-this.areaTopHeight-2}}]),t}(h["f"]);Object(l["a"])([Object(h["e"])()],T.prototype,"chatRoom",void 0),Object(l["a"])([Object(h["e"])()],T.prototype,"studentQuestion",void 0),T=Object(l["a"])([h["a"]],T);var L=T,j=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"teacherLiveTopBar"}},[n("div",{staticClass:"interactionMenuBtn iconfont",on:{click:e.handleInteractionMenuBtnClick}},[e._v(e._s(e.interactionMenuOpenState?"":""))]),n("div",{staticClass:"tabSwitchBtn barrage",class:{hover:"barrage"===e.selectedTab},on:{click:function(t){return e.handleSwitchTab("barrage")}}},[e._v(" 弹幕 "),n("div",{directives:[{name:"show",rawName:"v-show",value:"barrage"===e.selectedTab,expression:"selectedTab==='barrage'"}],staticClass:"bottomLine"})]),n("div",{staticClass:"tabSwitchBtn onlineUser",class:{hover:"onlineUser"===e.selectedTab},on:{click:function(t){return e.handleSwitchTab("onlineUser")}}},[e._v(" 在线学员("+e._s(e.onlineUserCount)+") "),n("div",{directives:[{name:"show",rawName:"v-show",value:"onlineUser"===e.selectedTab,expression:"selectedTab==='onlineUser'"}],staticClass:"bottomLine"})])])},U=[],_=function(e){function t(){return Object(a["a"])(this,t),Object(r["a"])(this,Object(c["a"])(t).apply(this,arguments))}return Object(u["a"])(t,e),Object(o["a"])(t,[{key:"handleSwitchTab",value:function(e){return e}},{key:"handleInteractionMenuBtnClick",value:function(){return!this.interactionMenuOpenState}}]),t}(h["f"]);Object(l["a"])([Object(h["d"])({default:1})],_.prototype,"onlineUserCount",void 0),Object(l["a"])([Object(h["d"])({default:"barrage"})],_.prototype,"selectedTab",void 0),Object(l["a"])([Object(h["d"])({default:!1})],_.prototype,"interactionMenuOpenState",void 0),Object(l["a"])([Object(h["b"])("switchTab")],_.prototype,"handleSwitchTab",null),Object(l["a"])([Object(h["b"])("interactionMenuOpenStateChange")],_.prototype,"handleInteractionMenuBtnClick",null),_=Object(l["a"])([h["a"]],_);var E=_,A=E,N=(n("07ce"),n("2877")),H=Object(N["a"])(A,j,U,!1,null,"cb8abf8e",null),M=H.exports,P=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"chatRoom"}},e._l(e.speakList,(function(t){return n("div",{key:t.id,staticClass:"speakChunk"},[void 0===t.msgType||null===t.msgType||""===t.msgType?[n("span",{staticClass:"speakUser"},[n("div",{staticClass:"userImg"},[n("img",{attrs:{src:t.user.pic,alt:t.user.nick}})]),""!==e.chatRoomGlobalUserType(t.user.userType)?n("div",{staticClass:"userTypeFlag"},[e._v(e._s(e.chatRoomGlobalUserType(t.user.userType)))]):e._e(),n("div",{staticClass:"userNick"},[e._v(e._s(t.user.nick)+"：")])]),n("span",{staticClass:"speakContent",domProps:{innerHTML:e._s(t.content)}})]:e._e(),"reward"===t.msgType?n("div",{staticClass:"gift"},[n("span",{staticClass:"speakUser"},[n("div",{staticClass:"userImg"},[n("img",{attrs:{src:t.user.pic,alt:t.user.nick}})]),n("div",{staticClass:"userNick"},[e._v(e._s(t.user.nick)+"：")])]),n("span",{staticClass:"speakContent"},[e._v("送给老师"+e._s(t.content.goodNum)+"个"+e._s(t.content.rewardContent))])]):e._e()],2)})),0)},R=[],Q=function(e){function t(){return Object(a["a"])(this,t),Object(r["a"])(this,Object(c["a"])(t).apply(this,arguments))}return Object(u["a"])(t,e),Object(o["a"])(t,[{key:"handleNewSpeak",value:function(){var e=this;this.$nextTick((function(){e.scrollToBottom()}))}},{key:"chatRoomGlobalUserType",value:function(e){return"string"===typeof p["b"][e]?p["b"][e]:""}},{key:"scrollToBottom",value:function(){var e=document.getElementById("chatRoom");e.scrollTop=e.scrollHeight}}]),t}(h["f"]);Object(l["a"])([Object(h["d"])({default:[]})],Q.prototype,"speakList",void 0),Object(l["a"])([Object(h["g"])("speakList")],Q.prototype,"handleNewSpeak",null),Q=Object(l["a"])([h["a"]],Q);var x=Q,B=x,$=(n("56ba"),Object(N["a"])(B,P,R,!1,null,"491ea7f4",null)),F=$.exports,D=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{attrs:{id:"onlineUser"},on:{scroll:e.handleUserInfoScroll}},[e._l(e.onlineUserList,(function(t){return["teacher"!==t.userType?s("div",{key:t.userid,staticClass:"userInfo"},[s("div",{staticClass:"left"},[s("div",{staticClass:"userImg"},[s("img",{attrs:{src:t.pic,alt:t.nick}})]),t.banned?s("img",{staticClass:"isbanned",attrs:{src:n("90df"),alt:"禁言中"}}):e._e()]),s("div",{staticClass:"right"},[""!==e.chatRoomGlobalUserType(t.userType)?s("div",{staticClass:"userTypeFlag"},[e._v(e._s(e.chatRoomGlobalUserType(t.userType)))]):e._e(),s("div",{staticClass:"userNickName"},[e._v(e._s(t.nick))])])]):e._e()]}))],2)},Y=[],z=function(e){function t(){return Object(a["a"])(this,t),Object(r["a"])(this,Object(c["a"])(t).apply(this,arguments))}return Object(u["a"])(t,e),Object(o["a"])(t,[{key:"getOnlineUserList",value:function(){return{onlineUserListPageNumber:this.onlineUserListPageNumber+1,onlineUserListPageCount:this.onlineUserListPageCount}}},{key:"chatRoomGlobalUserType",value:function(e){return"string"===typeof p["b"][e]?p["b"][e]:""}},{key:"scrollToTop",value:function(){var e=document.getElementById("onlineUser");e.scrollTop=0}},{key:"handleUserInfoScroll",value:function(e){var t=e.target;this.onlineUserList.length>=this.onlineUserListPageNumber*this.onlineUserListPageCount&&t.scrollHeight-100<=t.scrollTop+t.offsetHeight&&!this.scrollLoadingFLag&&this.getOnlineUserList()}}]),t}(h["f"]);Object(l["a"])([Object(h["d"])({default:[]})],z.prototype,"onlineUserList",void 0),Object(l["a"])([Object(h["d"])({default:40})],z.prototype,"onlineUserListPageCount",void 0),Object(l["a"])([Object(h["d"])({default:1})],z.prototype,"onlineUserListPageNumber",void 0),Object(l["a"])([Object(h["d"])({default:!1})],z.prototype,"scrollLoadingFLag",void 0),Object(l["a"])([Object(h["b"])("getOnlineUserList")],z.prototype,"getOnlineUserList",null),z=Object(l["a"])([h["a"]],z);var G=z,J=G,V=(n("7eef"),Object(N["a"])(J,D,Y,!1,null,"8281b890",null)),q=V.exports,W=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"studentQuestion"}},[e._l(e.studentQuestionList,(function(t,s){return n("div",{key:t.id,staticClass:"speakContainer"},[n("span",{staticClass:"speakTime"},[e._v(e._s(e._f("speakTime")(t.time)))]),"string"===typeof t.studentContent?n("span",{staticClass:"targetQuestion"},[e._v(e._s(e.getStudentName(t)+"："+t.studentContent))]):e._e(),n("div",{staticClass:"speakChunk",class:{student:"S_QUESTION"===t.event||"S_QUESTION"===t.EVENT},on:{click:function(t){return t.stopPropagation(),e.handleSelectQuestion(s)}}},[n("span",{staticClass:"speakUser"},[n("div",{staticClass:"userImg"},[n("img",{attrs:{src:t.user.pic,alt:t.user.nick}})]),""!==e.chatRoomGlobalUserType(t.user.userType)?n("div",{staticClass:"userTypeFlag"},[e._v(e._s(e.chatRoomGlobalUserType(t.user.userType)))]):e._e(),n("div",{staticClass:"userNick",class:{special:""!==e.chatRoomGlobalUserType(t.user.userType)}},[e._v(e._s(t.user.nick)+e._s(e.showAnswerStudentName(t))+"：")])]),n("span",{staticClass:"speakContent",domProps:{innerHTML:e._s(t.content)}})])])})),n("div",{staticClass:"studentQuestionPlaceholder"})],2)},K=[],X=function(e){function t(){return Object(a["a"])(this,t),Object(r["a"])(this,Object(c["a"])(t).apply(this,arguments))}return Object(u["a"])(t,e),Object(o["a"])(t,[{key:"chatRoomGlobalUserType",value:function(e){return"string"===typeof p["b"][e]?p["b"][e]:""}},{key:"getStudentName",value:function(e){return"string"===typeof e.studentName&&""!==e.studentName?e.studentName:k["b"]}},{key:"showAnswerStudentName",value:function(e){return"T_ANSWER"!==e.event&&"T_ANSWER"!==e.EVENT||"string"!==typeof e.s_userId||""===e.s_userId?"":"string"===typeof e.studentName&&""!==e.studentName?"回复"+e.studentName:"回复"+k["b"]}},{key:"scrollToBottom",value:function(){var e=document.getElementById("studentQuestion");e.scrollTop=e.scrollHeight}},{key:"handleSelectQuestion",value:function(e){return this.studentQuestionList[e]}}]),t}(h["f"]);Object(l["a"])([Object(h["d"])({default:[]})],X.prototype,"studentQuestionList",void 0),Object(l["a"])([Object(h["g"])("studentQuestionList")],X.prototype,"scrollToBottom",null),Object(l["a"])([Object(h["b"])("selectQuestion")],X.prototype,"handleSelectQuestion",null),X=Object(l["a"])([Object(h["a"])({filters:{speakTime:function(e){return void 0===e?b()((new Date).getTime()).format("HH:mm"):b()(Number(e)).format("HH:mm")}}})],X);var Z=X,ee=Z,te=(n("80d2"),Object(N["a"])(ee,W,K,!1,null,"0765e72e",null)),ne=te.exports,se=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"teacherAnswer"},on:{click:function(e){e.stopPropagation()},mousedown:function(e){e.stopPropagation()}}},[void 0!==e.teacherAnswerInfo.user?[n("div",{staticClass:"teacherAnswerQuestionInfo"},["string"===typeof e.teacherAnswerInfo.content?n("span",{staticClass:"teacherAnswerQuestionInfoDetail"},[e._v(" "+e._s(e.teacherAnswerInfo.user.nick+"：")+" "),n("span",{domProps:{innerHTML:e._s(e.teacherAnswerInfo.content)}})]):n("span",{staticClass:"teacherAnswerQuestionInfoDetail"},[e._v("回复："+e._s(e.teacherAnswerInfo.user.nick))]),n("span",{staticClass:"iconfont cancel",on:{click:e.handleCancelAnswer}},[e._v("")])])]:e._e(),n("div",{staticClass:"answerContentContainer"},[n("a-input",{staticClass:"answerContentInput",attrs:{type:"textarea","max-length":"300",autosize:{maxRows:3}},model:{value:e.answerContent,callback:function(t){e.answerContent=t},expression:"answerContent"}}),n("button",{staticClass:"answerBtn",on:{click:e.handleSubmit}},[e._v("发送")])],1)],2)},ie=[],ae=function(e){function t(){var e;return Object(a["a"])(this,t),e=Object(r["a"])(this,Object(c["a"])(t).apply(this,arguments)),e.answerTargetStudent=!0,e.valueHead="",e.answerContent="",e}return Object(u["a"])(t,e),Object(o["a"])(t,[{key:"handleTeacherAnswerInfoChange",value:function(){this.valueHead="回复".concat(void 0!==this.teacherAnswerInfo.user&&"string"===typeof this.teacherAnswerInfo.user.nick?this.teacherAnswerInfo.user.nick:"","："),this.answerTargetStudent=!0}},{key:"handleSubmit",value:function(){var e=this.answerContent;return this.answerContent="",{s_userId:this.answerTargetStudent?this.teacherAnswerInfo.user.userId:null,content:e}}},{key:"handleCancelAnswer",value:function(){return!0}}]),t}(h["f"]);Object(l["a"])([Object(h["d"])({default:!1})],ae.prototype,"teacherAnswerShowStatus",void 0),Object(l["a"])([Object(h["d"])({default:{}})],ae.prototype,"teacherAnswerInfo",void 0),Object(l["a"])([Object(h["g"])("teacherAnswerInfo")],ae.prototype,"handleTeacherAnswerInfoChange",null),Object(l["a"])([Object(h["b"])("sendAnswer")],ae.prototype,"handleSubmit",null),Object(l["a"])([Object(h["b"])("cancelAnswer")],ae.prototype,"handleCancelAnswer",null),ae=Object(l["a"])([h["a"]],ae);var oe=ae,re=oe,ce=(n("08e0"),Object(N["a"])(re,se,ie,!1,null,"7189a4e8",null)),ue=ce.exports,le=function(e){function t(){var e;return Object(a["a"])(this,t),e=Object(r["a"])(this,Object(c["a"])(t).apply(this,arguments)),e.selectedTabName="barrage",e.interactionMenuOpenState=!1,e.interactionMenuClicked=!1,e}return Object(u["a"])(t,e),Object(o["a"])(t,[{key:"handleSwitchTab",value:function(e){this.selectedTabName=e}},{key:"handleInteractionMenuOpenStateChange",value:function(e){this.interactionMenuOpenState=e,this.interactionMenuClicked=!0}},{key:"handleRedPacketClick",value:function(){this.$message.info("暂未开放")}},{key:"handleTestClick",value:function(){this.$message.info("暂未开放")}},{key:"handleRankClick",value:function(){this.$message.info("暂未开放")}},{key:"mounted",value:function(){this.$message.config({getContainer:function(){return document.getElementById("teacherLive")}})}},{key:"destroyed",value:function(){this.$message.config({getContainer:function(){return document.body}})}}]),t}(Object(h["c"])(S,L));le=Object(l["a"])([Object(h["a"])({components:{TopBar:M,ChatRoom:F,OnlineUser:q,StudentQuestion:ne,TeacherAnswer:ue}})],le);var he=le,de=he,fe=(n("e329"),Object(N["a"])(de,s,i,!1,null,"3a6720d2",null));t["default"]=fe.exports},a621:function(e,t,n){},cb3d:function(e,t,n){},e329:function(e,t,n){"use strict";var s=n("2e74"),i=n.n(s);i.a},f679:function(e,t,n){}}]);
//# sourceMappingURL=teacherLive.96c1d768.js.map